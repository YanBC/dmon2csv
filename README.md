# dmon2csv

This repo contains scripts to convert the output of `nvidia-smi dmon`/`nvidia-smi daemon`/`nvidia-smi pmon` to csv file for better analysis.

## Examples of nvidia-smi outputs
Simple outputs `nvidia-smi dmon -i 1 -s pucvmet`
```
# gpu   pwr gtemp mtemp    sm   mem   enc   dec  mclk  pclk pviol tviol    fb  bar1 sbecc dbecc   pci rxpci txpci
# Idx     W     C     C     %     %     %     %   MHz   MHz     %  bool    MB    MB  errs  errs  errs  MB/s  MB/s
    1    94    34    48    35     4     0     0  1593  1155     0     0 21462    14     0     0     0    58     0
    1    83    34    47    35     4     0     0  1593  1155     0     0 21462    14     0     0     0    71   692
    1    97    34    48    33     4     0     0  1593  1155     0     0 21462    14     0     0     0   228   569
```

Outputs with timestamp `nvidia-smi dmon -i 1 -s pucvmet -o T`
```
#Time        gpu   pwr gtemp mtemp    sm   mem   enc   dec  mclk  pclk pviol tviol    fb  bar1 sbecc dbecc   pci rxpci txpci
#HH:MM:SS    Idx     W     C     C     %     %     %     %   MHz   MHz     %  bool    MB    MB  errs  errs  errs  MB/s  MB/s
 09:56:54      1    69    30    45     0     0     0     0  1593  1155     0     0 21462    14     0     0     0     0     0
 09:56:55      1    69    30    45     0     0     0     0  1593  1155     0     0 21462    14     0     0     0     0     0
 09:56:56      1    84    30    45     0     0     0     0  1593  1410     0     0 21462    14     0     0     0     0     0
```

Outputs with date and time `nvidia-smi dmon -i 1 -s pucvmet -o DT`
```
#Date       Time        gpu   pwr gtemp mtemp    sm   mem   enc   dec  mclk  pclk pviol tviol    fb  bar1 sbecc dbecc   pci rxpci txpci
#YYYYMMDD   HH:MM:SS    Idx     W     C     C     %     %     %     %   MHz   MHz     %  bool    MB    MB  errs  errs  errs  MB/s  MB/s
 20231203   09:57:37      1   130    40    50    62     6     0     0  1593  1410     0     0 21462    14     0     0     0  3889   519
 20231203   09:57:38      1   131    40    50    63     5     0     0  1593  1410     0     0 21462    14     0     0     0  4167   510
 20231203   09:57:39      1   380    46    52    55    11     0     0  1593  1410     0     0 21462    14     0     0     0  4278   545
```


## `nvidia-smi` monitoring features
The `nvidia-smi` tool provides a rich set of monitoring and device query features. The followings are the most relevent to this repo, taken from the nvidia-smi help page.
```
 Device Monitoring:
    dmon                        Displays device stats in scrolling format.
                                "nvidia-smi dmon -h" for more information.

    daemon                      Runs in background and monitor devices as a daemon process.
                                This is an experimental feature. Not supported on Windows baremetal
                                "nvidia-smi daemon -h" for more information.

    replay                      Used to replay/extract the persistent stats generated by daemon.
                                This is an experimental feature.
                                "nvidia-smi replay -h" for more information.

 Process Monitoring:
    pmon                        Displays process stats in scrolling format.r a file.
                                "nvidia-smi pmon -h" for more information.or a file.
```

It is worth noting that NVIDIA is adding a new feature called `nvidia-smi stats` to the smi tool set, which would output csv style metrics. The tool is still experimental but support querying GPU stats at a higher frequency. You should tryout this feature before using this repo.
